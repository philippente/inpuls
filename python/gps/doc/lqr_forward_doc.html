<!doctype html><html><head><meta charset='utf-8'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.4.1/github-markdown.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/mdmath.css">
</head><body class="markdown-body">
<h1>LQR Forward pass</h1>
<h2>Notation</h2>
<p>In this part we consider a normal distribution over <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><annotation encoding="application/x-tex">{\bold x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><annotation encoding="application/x-tex">{\bold u}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span></span></span></eq>:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mtext> </mtext><mo>∼</mo><mtext> </mtext><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mrow><mi>μ</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">Σ</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex"> \\begin{pmatrix}{\\bold x}\\\\{\\bold u}\\end{pmatrix}\\ \\sim\\ {\\mathscr N}({\\bold \\mu}, {\\bold \\Sigma}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mrel"><span class="mspace"> </span><span class="mrel">∼</span></span><span class="mord displaystyle textstyle uncramped"><span class="mspace"> </span><span class="mord mathscr" style="margin-right:0.3525em;">N</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="mclose">)</span></span></span></span></span></eqn></section>
<p>where</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>μ</mi></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi mathvariant="bold">x</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi mathvariant="bold">u</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> {\\bold \\mu}=\\begin{pmatrix}{\\bold \\mu}\_{\\bold x}\\\\{\\bold \\mu}\_{\\bold u}\\end{pmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow></mrow><annotation encoding="application/x-tex"> </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0em;"></span><span class="strut bottom" style="height:0em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">Σ</mi></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mtable><mtr><mtd><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex"> {\\bold \\Sigma}=\\begin{pmatrix}{\\bold \\Sigma}\_{{\\bold x},{\\bold x}}&amp;{\\bold \\Sigma}\_{{\\bold x},{\\bold u}}\\\\{\\bold \\Sigma}\_{{\\bold u},{\\bold x}}&amp;{\\bold \\Sigma}\_{{\\bold u},{\\bold u}}\\end{pmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></eqn></section>
<h2>Code</h2>
<p>The forward recursion function takes as arguments</p>
<ul>
<li><code>traj_distr</code>: The policy object containing the linear gaussian policy</li>
<li><code>traj_info</code>: This object contains the dynamics</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, traj_distr, traj_info)</span>:</span>
</div></code></pre>
<p>We get the number of timesteps and the dimensions of the states and the actions from the policy object:</p>
<pre class="hljs"><code><div>T = traj_distr.T
dimU = traj_distr.dU
dimX = traj_distr.dX
</div></code></pre>
<p>We use slice syntax so that <code>sigma[index_x, index_u]</code> means <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">{\bold \Sigma}_{{\bold x},{\bold u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></eq> etc.</p>
<pre class="hljs"><code><div>index_x = slice(dimX)
index_u = slice(dimX, dimX + dimU)
</div></code></pre>
<p>We allocate space for <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>μ</mi></mrow></mrow><annotation encoding="application/x-tex">{\bold \mu}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">μ</span></span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">Σ</mi></mrow></mrow><annotation encoding="application/x-tex">{\bold \Sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Σ</span></span></span></span></span></eq> and set the initial values for <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mn>0</mn><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">{\bold \mu}_{0,{\bold x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></eq> and <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mn>0</mn><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow><annotation encoding="application/x-tex">{\bold \Sigma}_{0,{\bold x}{\bold x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></eq>:</p>
<pre class="hljs"><code><div>sigma = np.zeros((T, dimX + dimU, dimX + dimU))
mu = np.zeros((T, dimX + dimU))

mu[<span class="hljs-number">0</span>, index_x] = traj_info.x0mu
sigma[<span class="hljs-number">0</span>, index_x, index_x] = traj_info.x0sigma
</div></code></pre>
<p>We iterate over <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span></span></span></span></eq> and compute:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">K</mi></mrow><mi>t</mi></msub><msub><mrow><mi>μ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> {\\bold \\mu}\_{t,{\\bold u}} = {\\bold K}\_t{\\bold \\mu}\_{t,{\\bold x}}+{\\bold k}\_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>t</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex"> {\\bold \\Sigma}\_{t,{\\bold x},{\\bold u}} = {\\bold \\Sigma}\_{t,{\\bold x},{\\bold x}}{\\bold K}\_t^T </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.177439em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">K</mi></mrow><mi>t</mi></msub><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow><annotation encoding="application/x-tex"> {\\bold \\Sigma}\_{t,{\\bold u},{\\bold x}} = {\\bold K}\_t{\\bold \\Sigma}\_{t,{\\bold x},{\\bold x}} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">u</mi></mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">K</mi></mrow><mi>t</mi></msub><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>t</mi><mi>T</mi></msubsup><mo>+</mo><mrow><msub><mi mathvariant="bold">Σ</mi><mrow><mi>p</mi><mi>o</mi><mi>l</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex"> {\\bold \\Sigma}\_{t,{\\bold u}{\\bold u}} = {\\bold K}\_t{\\bold \\Sigma}\_{t,{\\bold x},{\\bold x}}{\\bold K}\_t^T+{\\bold \\Sigma\_{pol,t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.177439em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathbf">Σ</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">p</span><span class="mord mathit mtight">o</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span></eqn></section>
<pre class="hljs"><code><div><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(T):
    mu[t, index_u] = traj_distr.K[t, :, :].dot(mu[t, index_x]) + \
                     traj_distr.k[t, :]

    sigma[t, index_x, index_u] = \
        sigma[t, index_x, index_x].dot(traj_distr.K[t, :, :].T)

    sigma[t, index_u, index_x] = \
        traj_distr.K[t, :, :].dot(sigma[t, index_x, index_x])

    sigma[t, index_u, index_u] = \
        traj_distr.K[t, :, :].dot(sigma[t, index_x, index_x]).dot(
            traj_distr.K[t, :, :].T
        ) + traj_distr.pol_covar[t, :, :]
</div></code></pre>
<p>for <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>&lt;</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t&lt;T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></eq> we compute:</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi>μ</mi></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">F</mi></mrow><mi>t</mi></msub><msub><mrow><mi>μ</mi></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mi mathvariant="bold">f</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex"> {\\bold \\mu}\_{t+1,{\\bold x}}={\\bold F}\_t{\\bold \\mu}\_t+{\\bold f}\_t </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">μ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></eqn></section>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo separator="true">,</mo><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub><mo>=</mo><msub><mrow><mi mathvariant="bold">F</mi></mrow><mi>t</mi></msub><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mi>t</mi></msub><msubsup><mrow><mi mathvariant="bold">F</mi></mrow><mi>t</mi><mi>T</mi></msubsup><mo>+</mo><msub><mrow><mi mathvariant="bold">Σ</mi></mrow><mrow><mi>d</mi><mi>y</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex"> {\\bold \\Sigma}\_{t+1,{\\bold x},{\\bold x}}={\\bold F}\_t{\\bold \\Sigma}\_t{\\bold F}\_t^T+{\\bold \\Sigma}\_{dyn} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.177439em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span><span class="mpunct mtight">,</span><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Σ</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">d</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></eqn></section>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> t &lt; T - <span class="hljs-number">1</span>:
    mu[t+<span class="hljs-number">1</span>, index_x] = Fm[t, :, :].dot(mu[t, :]) + fv[t, :]

    sigma[t+<span class="hljs-number">1</span>, index_x, index_x] = \
        Fm[t, :, :].dot(sigma[t, :, :]).dot(Fm[t, :, :].T) + \ 
        dyn_covar[t, :, :]
</div></code></pre>
<p>After that the loop ends and we return <code>mu</code> and <code>sigma</code>:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">return</span> mu, sigma
</div></code></pre>

</body></html>
